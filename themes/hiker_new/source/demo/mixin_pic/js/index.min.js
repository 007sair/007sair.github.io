!function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,t),s.l=!0,s.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/demo/mixin_pic/",t(t.s=38)}([function(e,t){e.exports=vendor_library},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={loading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"加载中";return mu.open({type:"loading",mask:!1,content:e})},isWeiXin:function(){return"micromessenger"==window.navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},loadImage:function(e){return new Promise(function(t,n){var i=new Image;i.onload=function(){i.setAttribute("crossOrigin","anonymous"),t(i)},i.onerror=n,i.src=e})},sequenceTasks:function(e){function t(e,t){return e.push(t),e}var n=t.bind(null,[]);return e.reduce(function(e,t){return e.then(t).then(n)},Promise.resolve())},css:function(){function e(e){return(e+"").replace(/^-ms-/,"ms-").replace(/-([a-z]|[0-9])/gi,function(e,t){return(t+"").toUpperCase()})}function t(e){return e.replace(/([A-Z]|^ms)/g,"-$1").toLowerCase()}function n(){var t=r,n=["-webkit-","-moz-","-ms-","-o-",""],i=0;do{if(e(n[i]+"transform")in t)return n[i]}while(++i<n.length);return""}function i(t){var i=r,s=n();return e(t)in i&&t||e(s+t)in i&&s+t||t}function s(t){var n=e(i(t));return n in r&&n||""}function a(e){var t={};return Object.keys(e).forEach(function(n){var s=i(n);t[s]=e[n]}),t}var r=document.createElement("div").style;return{divStyle:r,camelCase:e,unCamelCase:t,cssVender:n,fixCSS:i,isCSS:s,prefix:a}}}},function(e,t,n){e.exports=n.p+"images/d_arrow.png?v=b305a717"},function(e,t,n){e.exports=n.p+"images/bgs/1.png?v=cb8475a3"},function(e,t,n){e.exports=n.p+"images/bgs/10.png?v=4a54683f"},function(e,t,n){e.exports=n.p+"images/bgs/2.png?v=59e8597f"},function(e,t,n){e.exports=n.p+"images/bgs/3.png?v=64fa0fdf"},function(e,t,n){e.exports=n.p+"images/bgs/4.png?v=bbf843df"},function(e,t,n){e.exports=n.p+"images/bgs/5.png?v=dae3de9f"},function(e,t,n){e.exports=n.p+"images/bgs/6.png?v=d155578f"},function(e,t,n){e.exports=n.p+"images/bgs/7.png?v=cce46980"},function(e,t,n){e.exports=n.p+"images/bgs/8.png?v=e3a155d6"},function(e,t,n){e.exports=n.p+"images/bgs/9.png?v=1d219d6b"},function(e,t,n){e.exports=n.p+"images/bgs_front/10.png?v=53ec37d2"},function(e,t,n){e.exports=n.p+"images/bgs_small/1.png?v=9e49623f"},function(e,t,n){e.exports=n.p+"images/bgs_small/10.png?v=4e0f6309"},function(e,t,n){e.exports=n.p+"images/bgs_small/2.png?v=44f4301e"},function(e,t,n){e.exports=n.p+"images/bgs_small/3.png?v=af914d24"},function(e,t,n){e.exports=n.p+"images/bgs_small/4.png?v=f27c1c35"},function(e,t,n){e.exports=n.p+"images/bgs_small/5.png?v=717fd362"},function(e,t,n){e.exports=n.p+"images/bgs_small/6.png?v=2965f584"},function(e,t,n){e.exports=n.p+"images/bgs_small/7.png?v=ae42479b"},function(e,t,n){e.exports=n.p+"images/bgs_small/8.png?v=d9c9e555"},function(e,t,n){e.exports=n.p+"images/bgs_small/9.png?v=23201485"},function(e,t,n){e.exports=n.p+"images/footer.png?v=5eee4afa"},function(e,t,n){e.exports=n.p+"images/portrait.png?v=b843735d"},function(e,t,n){e.exports=n.p+"images/stickers/1.png?v=975c7984"},function(e,t,n){e.exports=n.p+"images/stickers/2.png?v=17ef9802"},function(e,t,n){e.exports=n.p+"images/stickers/3.png?v=d33d804d"},function(e,t,n){e.exports=n.p+"images/stickers/4.png?v=38fe3c71"},function(e,t,n){e.exports=n.p+"images/stickers/5.png?v=6e58298f"},function(e,t,n){e.exports=n.p+"images/stickers/6.png?v=23fca113"},function(e,t,n){e.exports=n.p+"images/stickers_small/1.png?v=7abd683e"},function(e,t,n){e.exports=n.p+"images/stickers_small/2.png?v=a3a70782"},function(e,t,n){e.exports=n.p+"images/stickers_small/3.png?v=b99fc939"},function(e,t,n){e.exports=n.p+"images/stickers_small/4.png?v=cba75ba6"},function(e,t,n){e.exports=n.p+"images/stickers_small/5.png?v=faef719e"},function(e,t,n){e.exports=n.p+"images/stickers_small/6.png?v=c4dedc8f"},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(s,a){try{var r=t[s](a),o=r.value}catch(e){return void n(e)}if(!r.done)return Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)});e(o)}return i("next")})}}n(39),n(40),n(41);var a=n(42),r=i(a),o=n(43),c=(i(o),n(1)),l=i(c),u=n(44),p=i(u);n(45);var f=n(46),d=n(49),g=i(d),m=n(50),h=i(m),v=n(51),b=i(v),y=l.default.loading("");window.onload=function(){function e(){var e="";return f.bgs_small.forEach(function(t){return e+='<li><img src="'+t+'" ></li>'}),e}function t(e){var t="";return f.stickers_small.forEach(function(e){return t+='<li><img src="'+e+'" ></li>'}),t}function n(e){var t=document.createElement("div");t.className="area-pop",t.innerHTML='\n            <div class="cont">\n                <i class="close js-pop-close"></i>\n                <div class="imgbox">\n                    <img class="'+(l.default.isWeiXin()?"stop-callout":"")+'" src="'+e+'">\n                </div>  \n                <p>长按保存图片</p>\n            </div>\n        ',document.body.appendChild(t)}var i=function(){var e=s(regeneratorRuntime.mark(function e(){var t,i,s,r,o,c,u,p,d,g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=2;break}return e.abrupt("return");case 2:return E=!0,t=l.default.loading("图片生成中，请稍后"),i=2e3,s=i/x,r=i/k,o=new b.default(i,s,r),e.next=8,o.mixin(C);case 8:return c=e.sent,e.next=11,o.join([a,f.img_footer]);case 11:u=e.sent,p=o.merge(u,c),d=o.border(p,150),g=d.toDataURL("image/jpeg",.9),setTimeout(function(){n(g),mu.close(t),E=!1},200);case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}();p.default.attach(document.body),mu.close(y);var a=f.bgs[0];!function(){var n='\n        <div class="wrapper">\n            <div class="area-canvas">\n                <div class="stage" id="js-stage" style="background-image:url('+a+')"></div>\n                <a class="btn-select" id="js-btn-select">选择人像</a>\n                <a class="btn-save" id="js-btn-save">保存</a>\n            </div>\n            <div class="area-actions">\n                <div class="cell-conts" id="js-conts">\n                    <ul class="bgs_small js-bgs_small active">'+e()+'</ul>\n                    <ul class="stickers_small js-stickers_small">'+t()+'</ul>\n                </div>\n                <div class="cell-tabs" id="js-tabs">\n                    <a class="active" href="javascript:;">背景</a>\n                    <a href="javascript:;">贴图</a>\n                </div>\n            </div>\n            <canvas style="display:none;" id="tmp-canvas"></canvas>\n            <canvas style="display:none;" id="cell-canvas"></canvas>\n        </div>';document.getElementById("app").innerHTML=n}();var o=document.querySelector(".area-canvas"),c=(0,r.default)("#js-stage"),u=(0,r.default)("#js-btn-select"),d=(0,r.default)("#js-btn-save"),m=((0,r.default)("#js-conts"),(0,r.default)("#js-tabs"),(0,r.default)(".js-bgs_small")),v=(0,r.default)(".js-stickers_small"),k=void 0,w=void 0,x=g.default.set(750,1107),_=o.offsetWidth/o.offsetHeight;_<=x?(k=.95*o.offsetWidth,w=k*g.default.reverse()):(w=.95*o.offsetHeight,k=w*x),c.width(k),c.height(w);var E=!1,C=[];d.on("click",i,!1),(0,r.default)(document.body).on("click",".js-pop-close",function(){(0,r.default)(".area-pop").remove()}),(0,r.default)(document.body).on("click","#js-tabs > a",function(){var e=(0,r.default)(this);if(e.hasClass("active"))return!1;var t=e.index();(0,r.default)("#js-tabs").find("a").eq(t).addClass("active").siblings("a").removeClass("active"),(0,r.default)("#js-conts").find("ul").eq(t).addClass("active").siblings("ul").removeClass("active")}),m.on("click","li",function(){var e=(0,r.default)(this).index();a=f.bgs[e],(0,r.default)(this).addClass("active").siblings("li").removeClass("active"),c.css({"background-image":"url("+a+")"})}),u.on("click",function(){var e=new h.default(c);e.create(f.portrait),e.updateCells(C)},!1),v.on("click","li",function(){var e=(0,r.default)(this).index(),t=new h.default(c);t.create(f.stickers[e]),t.updateCells(C)})}},function(e,t,n){e.exports=n(0)(127)},function(e,t,n){e.exports=n(0)(330)},function(e,t,n){"use strict";var i,s,a;"function"==typeof Symbol&&Symbol.iterator;!function(n,r){s=[],i=r,void 0!==(a="function"==typeof i?i.apply(t,s):i)&&(e.exports=a)}(window,function(){function e(e){this.opts=t({type:"default",content:"",mask:!0,maskClose:!0,delay:.25,time:0,animate:"scale",style:"",className:"",btn:!1},e),this.init()}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(e,t){return t=t||"",0!=t.replace(/\s/g,"").length&&new RegExp(" "+t+" ").test(" "+e.className+" ")}function i(e,t){n(e,t)||(e.className=""==e.className?t:e.className+" "+t)}function s(e,t){if(n(e,t)){for(var i=" "+e.className.replace(/[\t\r\n]/g,"")+" ";i.indexOf(" "+t+" ")>=0;)i=i.replace(" "+t+" "," ");e.className=i.replace(/^\s+|\s+$/g,"")}}function a(e,t){t=t||l("body"),e.parentNode===t&&t.removeChild(e)}var r="mu_modal",o=0,c={},l=function(e,t){return t=t||!1,t?document.querySelectorAll(e):document.querySelector(e)},u=function(e,t){return r+(e?"-"+e:"")+(t?"--"+t:"")},p=function(e){var t=l("#"+r+"-"+e);return!!t&&{wrap:t,mask:t.querySelector("."+u("mask")),main:t.querySelector("."+u("container")).children[0]}};e.prototype={constructor:e,init:function(){c[o]={config:this.opts,duration:{},delay:{}},this.insert()},insert:function(){var e=this,t=this.opts,n=document.createElement("div");n.id=r+"-"+o,n.className=u("wrap"),n.setAttribute("type",t.type),l("."+u("wrap"),!0).forEach(function(e){var n=e.getAttribute("type"),i=e.id.split(r+"-")[1];n===t.type&&f.close(i)}),"toast"===t.type&&(t.mask=!1),"alert"===t.type&&(t.content='<div class="'+u("alert_content")+'">'+t.content+"</div>"),"slide"===t.type&&(t.animate="slide"),"loading"===t.type&&(t.animate=!1,t.content=t.content?"<p>"+t.content+"</p>":t.content);var i=function(){"string"==typeof t.btn&&(t.btn=[t.btn]);var e,n=(t.btn||[]).length;return 0!==n&&t.btn?(t.btn=t.btn.reverse(),e='<span yes type="1">'+t.btn[0]+"</span>",2===n&&(e='<span no type="0">'+t.btn[1]+"</span>"+e),'<div class="'+u("alert_btns")+'">'+e+"</div>"):""}(),s=[u("mask"),t.animate?u("fade"):""].join(" "),a=[u("main"),u(t.type),t.from?u(t.type+"_"+t.from):null,t.className?t.className:null,t.animate?u(t.animate):""].filter(function(e){return e}).join(" ");"function"==typeof t.content&&(t.content=t.content.call(this,function(t){p(e.index).main.innerHTML=t})),n.innerHTML=[t.mask?'<div style="'+("string"==typeof t.mask?t.mask:"")+'" class="'+s+'"></div>':"",'<div class="'+u("container")+'">','<div class="'+a+'" style="'+(t.style?t.style:"")+'">',t.title?'<div class="'+u("title")+'">'+t.title+"</div>":"",t.content,t.btn?i:"","</div>","</div>"].join(""),l("body").appendChild(n),this.index=o++,this.emit(t),"function"==typeof c[this.index].config.open&&c[this.index].config.open.call(this)},emit:function(e){var t=this,n=p(this.index);if(n.wrap.offsetWidth,e.animate&&i(n.main,u(e.animate,"in")),e.mask&&n.mask&&(e.animate&&i(n.mask,u("fade","in")),e.maskClose&&n.mask.addEventListener("click",function(){f.close(t.index)})),e.btn){l("."+u("alert_btns")+" span",!0).forEach(function(n){n.addEventListener("click",function(){0==this.getAttribute("type")?(e.no&&e.no(),f.close(t.index)):e.yes?e.yes(t.index):f.close(t.index)})})}e.time&&(c[this.index].duration=setTimeout(function(){f.close(t.index)},1e3*e.time))}};var f={v:"1.0.0",open:function(t){return new e(t||{}).index},close:function(e){var t=p(e);if(t){var n=c[e].config;t.mask&&s(t.mask,u("fade","in")),s(t.main,u(n.animate,"in"));var i=n.animate?1e3*n.delay:0;clearTimeout(c[e].delay),c[e].delay=setTimeout(function(){a(t.wrap),"function"==typeof c[e].config.close&&c[e].config.close(),delete c[e]},i)}},closeAll:function(){var e=l("."+u("wrap"),!0);e.length&&e.forEach(function(e){a(_wrap)})}};return window.mu=f,f})},function(e,t,n){e.exports=n(0)(329)},function(e,t,n){e.exports=n(0)(126)},function(e,t,n){var i;!function(){"use strict";/**
	 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
	 *
	 * @codingstandard ftlabs-jsv2
	 * @copyright The Financial Times Limited [All Rights Reserved]
	 * @license MIT License (see LICENSE.txt)
	 */
function s(e,t){var n;if(t=t||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=t.touchBoundary||10,this.layer=e,this.tapDelay=t.tapDelay||200,this.tapTimeout=t.tapTimeout||700,!s.notNeeded(e)){for(var i=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],a=this,o=0,c=i.length;o<c;o++)a[i[o]]=function(e,t){return function(){return e.apply(t,arguments)}}(a[i[o]],a);r&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,i){var s=Node.prototype.removeEventListener;"click"===t?s.call(e,t,n.hijacked||n,i):s.call(e,t,n,i)},e.addEventListener=function(t,n,i){var s=Node.prototype.addEventListener;"click"===t?s.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),i):s.call(e,t,n,i)}),"function"==typeof e.onclick&&(n=e.onclick,e.addEventListener("click",function(e){n(e)},!1),e.onclick=null)}}var a=navigator.userAgent.indexOf("Windows Phone")>=0,r=navigator.userAgent.indexOf("Android")>0&&!a,o=/iP(ad|hone|od)/.test(navigator.userAgent)&&!a,c=o&&/OS 4_\d(_\d)?/.test(navigator.userAgent),l=o&&/OS [6-7]_\d/.test(navigator.userAgent),u=navigator.userAgent.indexOf("BB10")>0;s.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(o&&"file"===e.type||e.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(e.className)},s.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!r;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},s.prototype.sendClick=function(e,t){var n,i;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),i=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},s.prototype.determineEventType=function(e){return r&&"select"===e.tagName.toLowerCase()?"mousedown":"click"},s.prototype.focus=function(e){var t;o&&e.setSelectionRange&&0!==e.type.indexOf("date")&&"time"!==e.type&&"month"!==e.type?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},s.prototype.updateScrollParent=function(e){var t,n;if(!(t=e.fastClickScrollParent)||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},s.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},s.prototype.onTouchStart=function(e){var t,n,i;if(e.targetTouches.length>1)return!0;if(t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0],o){if(i=window.getSelection(),i.rangeCount&&!i.isCollapsed)return!0;if(!c){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},s.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n},s.prototype.onTouchMove=function(e){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))&&(this.trackingClick=!1,this.targetElement=null),!0)},s.prototype.findControl=function(e){return void 0!==e.control?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},s.prototype.onTouchEnd=function(e){var t,n,i,s,a,u=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(e.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,l&&(a=e.changedTouches[0],u=document.elementFromPoint(a.pageX-window.pageXOffset,a.pageY-window.pageYOffset)||u,u.fastClickScrollParent=this.targetElement.fastClickScrollParent),"label"===(i=u.tagName.toLowerCase())){if(t=this.findControl(u)){if(this.focus(u),r)return!1;u=t}}else if(this.needsFocus(u))return e.timeStamp-n>100||o&&window.top!==window&&"input"===i?(this.targetElement=null,!1):(this.focus(u),this.sendClick(u,e),o&&"select"===i||(this.targetElement=null,e.preventDefault()),!1);return!(!o||c||!(s=u.fastClickScrollParent)||s.fastClickLastScrollTop===s.scrollTop)||(this.needsClick(u)||(e.preventDefault(),this.sendClick(u,e)),!1)},s.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},s.prototype.onMouse=function(e){return!this.targetElement||(!!e.forwardedTouchEvent||(!e.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1))))},s.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===e.target.type&&0===e.detail||(t=this.onMouse(e),t||(this.targetElement=null),t)},s.prototype.destroy=function(){var e=this.layer;r&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},s.notNeeded=function(e){var t,n,i;if(void 0===window.ontouchstart)return!0;if(n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!r)return!0;if(t=document.querySelector("meta[name=viewport]")){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(u&&(i=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),i[1]>=10&&i[2]>=3&&(t=document.querySelector("meta[name=viewport]")))){if(-1!==t.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===e.style.msTouchAction||"manipulation"===e.style.touchAction||(!!(+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]>=27&&(t=document.querySelector("meta[name=viewport]"))&&(-1!==t.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))||("none"===e.style.touchAction||"manipulation"===e.style.touchAction))},s.attach=function(e,t){return new s(e,t)},void 0!==(i=function(){return s}.call(t,n,t,e))&&(e.exports=i)}()},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.p;!function(e){e.keys().forEach(function(e){var t=e.replace(/(.*\/)*([^.]+).*/gi,"$1").replace("./",""),i=e.replace(/(.*\/)*([^.]+).*/gi,"$2"),s="."+e.replace(/.+\./,"");n(47)("./"+t+i+s)})}(n(48));var s=["1.png","2.png","3.png","4.png","5.png","6.png","7.png","8.png","9.png","10.png"],a=["1.png","2.png","3.png","4.png","5.png","6.png"],r=i+"images/portrait.png",o=s.map(function(e){return i+"images/bgs/"+e}),c=s.map(function(e){return i+"images/bgs_small/"+e}),l=a.map(function(e){return i+"images/stickers/"+e}),u=a.map(function(e){return i+"images/stickers_small/"+e}),p=i+"images/footer.png";t.portrait=r,t.bgs=o,t.bgs_small=c,t.stickers=l,t.stickers_small=u,t.img_footer=p},function(e,t,n){function i(e){return n(s(e))}function s(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var a={"./bgs/1.png":3,"./bgs/10.png":4,"./bgs/2.png":5,"./bgs/3.png":6,"./bgs/4.png":7,"./bgs/5.png":8,"./bgs/6.png":9,"./bgs/7.png":10,"./bgs/8.png":11,"./bgs/9.png":12,"./bgs_front/10.png":13,"./bgs_small/1.png":14,"./bgs_small/10.png":15,"./bgs_small/2.png":16,"./bgs_small/3.png":17,"./bgs_small/4.png":18,"./bgs_small/5.png":19,"./bgs_small/6.png":20,"./bgs_small/7.png":21,"./bgs_small/8.png":22,"./bgs_small/9.png":23,"./d_arrow.png":2,"./footer.png":24,"./portrait.png":25,"./stickers/1.png":26,"./stickers/2.png":27,"./stickers/3.png":28,"./stickers/4.png":29,"./stickers/5.png":30,"./stickers/6.png":31,"./stickers_small/1.png":32,"./stickers_small/2.png":33,"./stickers_small/3.png":34,"./stickers_small/4.png":35,"./stickers_small/5.png":36,"./stickers_small/6.png":37};i.keys=function(){return Object.keys(a)},i.resolve=s,e.exports=i,i.id=47},function(e,t,n){function i(e){return n(s(e))}function s(e){var t=a[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var a={"./bgs/1.png":3,"./bgs/10.png":4,"./bgs/2.png":5,"./bgs/3.png":6,"./bgs/4.png":7,"./bgs/5.png":8,"./bgs/6.png":9,"./bgs/7.png":10,"./bgs/8.png":11,"./bgs/9.png":12,"./bgs_front/10.png":13,"./bgs_small/1.png":14,"./bgs_small/10.png":15,"./bgs_small/2.png":16,"./bgs_small/3.png":17,"./bgs_small/4.png":18,"./bgs_small/5.png":19,"./bgs_small/6.png":20,"./bgs_small/7.png":21,"./bgs_small/8.png":22,"./bgs_small/9.png":23,"./d_arrow.png":2,"./footer.png":24,"./portrait.png":25,"./stickers/1.png":26,"./stickers/2.png":27,"./stickers/3.png":28,"./stickers/4.png":29,"./stickers/5.png":30,"./stickers/6.png":31,"./stickers_small/1.png":32,"./stickers_small/2.png":33,"./stickers_small/3.png":34,"./stickers_small/4.png":35,"./stickers_small/5.png":36,"./stickers_small/6.png":37};i.keys=function(){return Object.keys(a)},i.resolve=s,e.exports=i,i.id=48},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.required(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.required();return this.x=e,this.y=t,this.x/this.y},reverse:function(){return this.x&&this.y?this.y/this.x:void this.required()},required:function(){throw new Error("缺少参数")}}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(1),r=function(e){return e&&e.__esModule?e:{default:e}}(a),o=function(){function e(t){i(this,e),this.$parent=t,this.cls="cell",this.$cell=null,this.isSelected=!1,this.w=0,this.h=0,this.dx=50,this.dy=50,this.rotation=0,this.scale=1,this.lastPosX=0,this.lastPosY=0}return s(e,[{key:"create",value:function(e){var t=this;this.oImg=new Image,this.oImg.src=e;var n=r.default.loading("图片加载中");this.oImg.onload=function(){t.w=this.width,t.h=this.height,t.$cell=$('\n                <div \n                    class="'+t.cls+'" \n                    style="top:'+t.offsetX+"px;left:"+t.offsetY+'px;"\n                    data-index='+t.index+' \n                >\n                    <i class="btn-close"></i>\n                    <i class="btn-scalerotate"></i>\n                    <img src="'+e+'">\n                </div>\n            ').appendTo(t.$parent),t.render(),t.watch(),t.bind(),t.focus(),mu.close(n)}}},{key:"render",value:function(){var e=Math.round(this.rotation);this.$cell.css(r.default.css().prefix({transform:"translate("+this.dx+"px, "+this.dy+"px) scale("+this.scale+") rotate("+e+"deg)"})),this.$cell.find("i[class*=btn-]").css(r.default.css().prefix({transform:"scale("+this.w/(this.w*this.scale)+")"}))}},{key:"updateCells",value:function(e){e.push(this),this.cells=e,this.index=e.length-1}},{key:"watch",value:function(){var e=void 0;Object.defineProperty(this,"isSelected",{get:function(){return e},set:function(t){e=t;var n="selected";this.isSelected?this.$cell.addClass(n).siblings("."+this.cls).removeClass(n):this.$cell.removeClass(n)},enumerable:!0,configurable:!0})}},{key:"focus",value:function(){var e=this;this.cells.forEach(function(t,n){t&&n!==e.index&&(t.isSelected=!1)}),this.isSelected=!this.isSelected}},{key:"bind",value:function(){function e(e){return{x:e.srcEvent.pageX-v,y:e.srcEvent.pageY-b}}function t(e,t){return-Math.atan2(t,e)/Math.PI*180}var n=this,i=new Hammer(this.$cell[0],{tap:{enable:!1}}),s=new Hammer.Pinch,a=new Hammer.Rotate;s.recognizeWith(a),i.add([s,a]);var r=null,o=this.scale,c=1,l=0,u=void 0,p=0,f=void 0,d=void 0;i.on("tap pinch pinchstart pinchend rotate rotatestart rotateend pan panend",function(e){if(!r){switch(e.preventDefault(),e.type){case"tap":/^btn-/.test(e.target.className)||n.focus();break;case"rotatestart":c=o,u=l,p=e.rotation;break;case"rotateend":c=o,u=l;break;case"rotate":var t=p-e.rotation;d=Math.abs(f-t),d<10&&(l=u-t),f=t;break;case"pinch":o=o=Math.max(.3,Math.min(c*e.scale,10));break;case"pinchstart":case"pinchend":c=o;break;case"pan":n.dx=e.deltaX+n.lastPosX,n.dy=e.deltaY+n.lastPosY;break;case"panend":n.lastPosX=n.dx,n.lastPosY=n.dy}n.scale=o,n.rotation=l,n.render()}});var g=new Hammer(this.$cell.find(".btn-scalerotate")[0],{tap:{enable:!1}}),m=void 0,h=void 0,v=void 0,b=void 0;g.on("panstart pan panend",function(i){switch(i.preventDefault(),i.type){case"panstart":r=i.target,m=n.$cell.width(),h=n.$cell.height(),v=n.$cell.offset().left+m/2,b=n.$cell.offset().top+h/2,p=t(e(i).y,e(i).x),c=o,u=l;break;case"pan":l=u-p+t(e(i).y,e(i).x),n.rotation=l;var s=Math.PI/180*i.angle,a=Math.tan(s)*i.deltaX;o=Math.max(.3,Math.min(c*((2*a+h)/h),10)),n.scale=o;break;case"panend":u=l,c=o,setTimeout(function(){r=null},0)}n.render()}),this.$cell.on("click",".btn-close",function(){return n.$cell.remove(),n.cells.splice(n.index,1,null),!1})}}]),e}();t.default=o},function(e,t,n){"use strict";function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function i(s,a){try{var r=t[s](a),o=r.value}catch(e){return void n(e)}if(!r.done)return Promise.resolve(o).then(function(e){i("next",e)},function(e){i("throw",e)});e(o)}return i("next")})}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(r),c=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;s(this,e),this.scale=i,this.w=t,this.h=n,this.ratio=this.w/this.h,this.init()}return a(e,[{key:"init",value:function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.w,this.canvas.height=this.h}},{key:"mixin",value:function(e){var t=this,n=this.canvas.getContext("2d"),s=function(){var s=i(regeneratorRuntime.mark(function i(s,a){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e.forEach(function(e){if(!e)return!1;e.isSelected=!1;var i={x:e.dx+e.w/2,y:e.dy+e.h/2};n.save(),n.translate(i.x*t.scale,i.y*t.scale),n.scale(e.scale*t.scale,e.scale*t.scale),n.rotate(e.rotation*Math.PI/180),n.translate(-i.x,-i.y),n.drawImage(e.oImg,e.dx,e.dy,e.w,e.h),n.restore()}),s(t.canvas);case 2:case"end":return i.stop()}},i,this)}));return function(e,t){return s.apply(this,arguments)}}();return new Promise(s)}},{key:"join",value:function(e){if(!Array.isArray(e))throw new Error("not a array");var t=this,n=document.createElement("canvas"),s=n.getContext("2d"),a=0,r=function(){var r=i(regeneratorRuntime.mark(function i(r,c){var l,u;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:l=[],u=[],e.forEach(function(e){u.push(function(){return o.default.loadImage(e)})}),o.default.sequenceTasks(u).then(function(e){e.forEach(function(e){var n=e.width/e.height,i=t.w/n,s={img:e,dx:0,dy:a,width:t.w,height:i};a+=i,l.push(s)}),n.width=t.w,n.height=a,l.forEach(function(e){s.drawImage(e.img,e.dx,e.dy,e.width,e.height)}),r(n)});case 4:case"end":return i.stop()}},i,this)}));return function(e,t){return r.apply(this,arguments)}}();return new Promise(r)}},{key:"merge",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n=[].concat(Array.prototype.slice.call(arguments));return e.width=n[0].width,e.height=n[0].height,n.forEach(function(e){"canvas"==e.tagName.toLowerCase()&&t.drawImage(e,0,0)}),e}},{key:"border",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#fff",i=document.createElement("canvas"),s=i.getContext("2d"),a=e.width/e.height,r=e.width-2*t,o=r/a;return i.width=r+2*t,i.height=o+2*t,s.fillStyle=n,s.fillRect(0,0,i.width,i.height),s.drawImage(e,t,t,r,o),i}}]),e}();t.default=c}]);